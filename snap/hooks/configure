#!/bin/sh

. "$SNAP/utils/utils.sh"
. "$SNAP/utils/service-args-utils.sh"
. "$SNAP/utils/tracing-enabled-utils.sh"
. "$SNAP/utils/endure-utils.sh"

handle_service_args_config()
{
    if ! service_args_has_changed; then
        log "service-args value was not changed."
		return 0
	fi

    service_args="$(get_service_args)"
    validate_service_args "$service_args"
    set_service_args "$service_args"
    write_service_args_file
    restart_polkadot
}

handle_tracing_enabled_config()
{
    if ! tracing_enabled_has_changed; then
        log "tracing-enabled value was not changed."
		return 0
	fi

    tracing_enabled="$(get_tracing_enabled)"
    validate_tracing_enabled
    set_tracing_enabled "$tracing_enabled"
    write_service_args_file
    restart_polkadot
}

handle_endure_config()
{
    if ! endure_has_changed; then
        log "endure value was not changed."
		return 0
	fi

    endure="$(get_endure)"
    set_endure "$endure"
}

handle_service_args_config
handle_tracing_enabled_config
handle_endure_config
